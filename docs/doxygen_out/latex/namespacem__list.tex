\hypertarget{namespacem__list}{}\section{m\+\_\+list Module Reference}
\label{namespacem__list}\index{m\+\_\+list@{m\+\_\+list}}


\subsubsection*{N\+A\+ME}

M\+\_\+list(3f) -\/ \mbox{[}M\+\_\+list\mbox{]} maintain simple lists (L\+I\+C\+E\+N\+SE\+:PD)  


\subsection*{Data Types}
\begin{DoxyCompactItemize}
\item 
type \mbox{\hyperlink{structm__list_1_1dictionary}{dictionary}}
\item 
interface \mbox{\hyperlink{interfacem__list_1_1insert}{insert}}
\item 
interface \mbox{\hyperlink{interfacem__list_1_1locate}{locate}}
\item 
interface \mbox{\hyperlink{interfacem__list_1_1remove}{remove}}
\item 
interface \mbox{\hyperlink{interfacem__list_1_1replace}{replace}}
\end{DoxyCompactItemize}
\subsection*{Functions/\+Subroutines}
\begin{DoxyCompactItemize}
\item 
subroutine, private \mbox{\hyperlink{namespacem__list_aeb2a9d8e479c44cca127db7c65abb1f3}{locate\+\_\+c}} (list, value, place, ier, errmsg)
\begin{DoxyCompactList}\small\item\em \subsubsection*{N\+A\+ME}

locate(3f) -\/ \mbox{[}M\+\_\+list\mbox{]} finds the index where a string is found or should be in a sorted array (L\+I\+C\+E\+N\+SE\+:PD) \end{DoxyCompactList}\item 
subroutine, private \mbox{\hyperlink{namespacem__list_a6b746f0ad79a6fbfbafcf0ee22e38891}{locate\+\_\+d}} (list, value, place, ier, errmsg)
\item 
subroutine, private \mbox{\hyperlink{namespacem__list_a533a0e5b16558efb391913e881a57040}{locate\+\_\+r}} (list, value, place, ier, errmsg)
\item 
subroutine, private \mbox{\hyperlink{namespacem__list_a5b1b93df5003d6dce72acba89e779638}{locate\+\_\+i}} (list, value, place, ier, errmsg)
\item 
subroutine, private \mbox{\hyperlink{namespacem__list_a216c9ec18769ee63a769cc25bc273022}{remove\+\_\+c}} (list, place)
\begin{DoxyCompactList}\small\item\em \subsubsection*{N\+A\+ME}

remove(3f) -\/ \mbox{[}M\+\_\+list\mbox{]} remove entry from an allocatable array at specified position (L\+I\+C\+E\+N\+SE\+:PD) \end{DoxyCompactList}\item 
subroutine, private \mbox{\hyperlink{namespacem__list_a6c5f971866302b40b5952ad919203461}{remove\+\_\+d}} (list, place)
\item 
subroutine, private \mbox{\hyperlink{namespacem__list_af5940ed6b39d9e3429e2784767db9e56}{remove\+\_\+r}} (list, place)
\item 
subroutine, private \mbox{\hyperlink{namespacem__list_a138b6450613db943177df6258f58e89b}{remove\+\_\+l}} (list, place)
\item 
subroutine, private \mbox{\hyperlink{namespacem__list_acdc3299515ed0402f4213d76d3e4d4cf}{remove\+\_\+i}} (list, place)
\item 
subroutine, private \mbox{\hyperlink{namespacem__list_adddd2b7443557b3727320c314170e001}{replace\+\_\+c}} (list, value, place)
\begin{DoxyCompactList}\small\item\em \subsubsection*{N\+A\+ME}

replace(3f) -\/ \mbox{[}M\+\_\+list\mbox{]} replace entry in a string array at specified position (L\+I\+C\+E\+N\+SE\+:PD) \end{DoxyCompactList}\item 
subroutine, private \mbox{\hyperlink{namespacem__list_a9cac0a0b0d325d26267d37648f8eada6}{replace\+\_\+d}} (list, value, place)
\item 
subroutine, private \mbox{\hyperlink{namespacem__list_ac2ef50718d66bfe2fc102a3d48a28cb2}{replace\+\_\+r}} (list, value, place)
\item 
subroutine, private \mbox{\hyperlink{namespacem__list_a0de977b7f38554ccd2e8b6e668f11648}{replace\+\_\+l}} (list, value, place)
\item 
subroutine, private \mbox{\hyperlink{namespacem__list_a8c67651ca2c2c90d921f23146577491b}{replace\+\_\+i}} (list, value, place)
\item 
subroutine, private \mbox{\hyperlink{namespacem__list_ac9b841bea6c2cfed1608b2809aaf07b4}{insert\+\_\+c}} (list, value, place)
\begin{DoxyCompactList}\small\item\em \subsubsection*{N\+A\+ME}

insert(3f) -\/ \mbox{[}M\+\_\+list\mbox{]} insert entry into a string array at specified position (L\+I\+C\+E\+N\+SE\+:PD) \end{DoxyCompactList}\item 
subroutine, private \mbox{\hyperlink{namespacem__list_affd8a9996750ccf655cf677136d9fc4e}{insert\+\_\+r}} (list, value, place)
\item 
subroutine, private \mbox{\hyperlink{namespacem__list_ae2356cb1ec5b313c3fcbad090d6eb440}{insert\+\_\+d}} (list, value, place)
\item 
subroutine, private \mbox{\hyperlink{namespacem__list_a6108584670ced9dc4469e76ceb808730}{insert\+\_\+l}} (list, value, place)
\item 
subroutine, private \mbox{\hyperlink{namespacem__list_a7d50f88bd8d25138af4e6d484aca2cbc}{insert\+\_\+i}} (list, value, place)
\item 
subroutine \mbox{\hyperlink{namespacem__list_aa562d18ce6890a8a1a96d77ff1d39948}{dict\+\_\+delete}} (self, key)
\begin{DoxyCompactList}\small\item\em \subsubsection*{N\+A\+ME}

dict\+\_\+delete(3f) -\/ \mbox{[}M\+\_\+list\mbox{]} delete entry by name from an allocatable sorted string array if it is present (L\+I\+C\+E\+N\+SE\+:PD) \end{DoxyCompactList}\item 
character(len=\+:) function, allocatable \mbox{\hyperlink{namespacem__list_a7b9bb0b8fa4b0eeef45d7fcdc21f8bf3}{dict\+\_\+get}} (self, key)
\begin{DoxyCompactList}\small\item\em \subsubsection*{N\+A\+ME}

dict\+\_\+get(3f) -\/ \mbox{[}M\+\_\+list\mbox{]} get value of key-\/value pair in a dictionary given key (L\+I\+C\+E\+N\+SE\+:PD) \end{DoxyCompactList}\item 
subroutine \mbox{\hyperlink{namespacem__list_aca66691fd75ea79859a1b4505d2125bb}{dict\+\_\+add}} (self, key, value)
\begin{DoxyCompactList}\small\item\em \subsubsection*{N\+A\+ME}

dict\+\_\+add(3f) -\/ \mbox{[}M\+\_\+list\mbox{]} add or replace a key-\/value pair in a dictionary (L\+I\+C\+E\+N\+SE\+:PD) \end{DoxyCompactList}\end{DoxyCompactItemize}
\subsection*{Variables}
\begin{DoxyCompactItemize}
\item 
logical, save \mbox{\hyperlink{namespacem__list_aaa3ea916cd8c669ebbc8ec9096c5bbca}{debug}} =.false.
\end{DoxyCompactItemize}


\subsection{Detailed Description}
\subsubsection*{N\+A\+ME}

M\+\_\+list(3f) -\/ \mbox{[}M\+\_\+list\mbox{]} maintain simple lists (L\+I\+C\+E\+N\+SE\+:PD) 

\subsubsection*{S\+Y\+N\+O\+P\+S\+IS}

\begin{DoxyVerb}use M_list, only : insert, replace, remove
use M_list, only : dictionary
\end{DoxyVerb}


\subsubsection*{D\+E\+S\+C\+R\+I\+P\+T\+I\+ON}

\begin{DoxyVerb}The M_list(3fm) module allows for maintaining an array as a sorted
list. An example is given that creates a keyword-value dictionary
using the lists.

The lists are maintained as simple allocatable arrays. Each time an
entry is added or deleted the array is re-allocated. Because of the
expense of reallocating the data these routines are best suited for
maintaining small lists that do not change size frequently.

The advantage is that the dictionary components are simple arrays
which can be easily accessed with standard routines.

BASIC LIST

subroutine locate(list,value,place,ier,errmsg)  finds the index where a
                                                value is found or should
                                                be in a sorted array and
                                                flag if the value exists
                                                already
subroutine insert(list,value,place)     insert entry into an allocatable
                                        array at specified position
subroutine replace(list,value,place)    replace entry in an allocatable
                                        array at specified position
subroutine remove(list,place)           remove entry from an allocatable
                                        array at specified position

BASIC DICTIONARY

Due to bugs in gfortran up to at least 7.4.0, this next section
does not work.

type dictionary

   character(len=:),allocatable :: key(:)
   character(len=:),allocatable :: value(:)
   integer,allocatable          :: count(:)

%get      get value from type(dictionary) given an existing key
%set      set or replace value for type(dictionary) given a key
%del      delete an existing key from type(dictionary)
%clr      empty a type(dictionary)
\end{DoxyVerb}


\subsubsection*{E\+X\+A\+M\+P\+LE}

Sample program

program demo\+\_\+\+M\+\_\+list use M\+\_\+list, only \+: insert, locate, replace, remove ! create a dictionary with character keywords, values, and value lengths ! using the routines for maintaining a list

use M\+\_\+list, only \+: locate, insert, replace implicit none character(len=\+:),allocatable \+:\+: keywords(\+:) character(len=\+:),allocatable \+:\+: values(\+:) integer,allocatable \+:\+: counts(\+:) integer \+:\+: i ! insert and replace entries call update(\textquotesingle{}b\textquotesingle{},\textquotesingle{}value of b\textquotesingle{}) call update(\textquotesingle{}a\textquotesingle{},\textquotesingle{}value of a\textquotesingle{}) call update(\textquotesingle{}c\textquotesingle{},\textquotesingle{}value of c\textquotesingle{}) call update(\textquotesingle{}c\textquotesingle{},\textquotesingle{}value of c again\textquotesingle{}) call update(\textquotesingle{}d\textquotesingle{},\textquotesingle{}value of d\textquotesingle{}) call update(\textquotesingle{}a\textquotesingle{},\textquotesingle{}value of a again\textquotesingle{}) ! show array write($\ast$,\textquotesingle{}($\ast$(a,\char`\"{}==$>$\char`\"{},\char`\"{}\mbox{[}\char`\"{},a,\char`\"{}\mbox{]}\char`\"{},/))\textquotesingle{})(trim(keywords(i)),values(i)(\+:counts(i)),i=1,size(keywords)) ! remove some entries call update(\textquotesingle{}a\textquotesingle{}) call update(\textquotesingle{}c\textquotesingle{}) write($\ast$,\textquotesingle{}($\ast$(a,\char`\"{}==$>$\char`\"{},\char`\"{}\mbox{[}\char`\"{},a,\char`\"{}\mbox{]}\char`\"{},/))\textquotesingle{})(trim(keywords(i)),values(i)(\+:counts(i)),i=1,size(keywords)) ! get some values write($\ast$,$\ast$)\textquotesingle{}get b=$>$\textquotesingle{},get(\textquotesingle{}b\textquotesingle{}) write($\ast$,$\ast$)\textquotesingle{}get d=$>$\textquotesingle{},get(\textquotesingle{}d\textquotesingle{}) write($\ast$,$\ast$)\textquotesingle{}get notthere=$>$\textquotesingle{},get(\textquotesingle{}notthere\textquotesingle{})

contains subroutine update(key,valin) character(len=$\ast$),intent(in) \+:\+: key character(len=$\ast$),intent(in),optional \+:\+: valin integer \+:\+: place integer \+:\+: ilen character(len=\+:),allocatable \+:\+: val if(present(valin))then val=valin ilen=len\+\_\+trim(val) ! find where string is or should be call locate(keywords,key,place) ! if string was not found insert it if(place.\+lt.\+1)then call insert(keywords,key,iabs(place)) call insert(values,val,iabs(place)) call insert(counts,ilen,iabs(place)) else call replace(values,val,place) call replace(counts,ilen,place) endif else call locate(keywords,key,place) if(place.\+gt.\+0)then call remove(keywords,place) call remove(values,place) call remove(counts,place) endif endif end subroutine update function get(key) result(valout) character(len=$\ast$),intent(in) \+:\+: key character(len=\+:),allocatable \+:\+: valout integer \+:\+: place ! find where string is or should be call locate(keywords,key,place) if(place.\+lt.\+1)then valout=\textquotesingle{}\textquotesingle{} else valout=values(place)(\+:counts(place)) endif end function get end program demo\+\_\+\+M\+\_\+list

Results\+:

d==$>$\mbox{[}value of d\mbox{]} c==$>$\mbox{[}value of c again\mbox{]} b==$>$\mbox{[}value of b\mbox{]} a==$>$\mbox{[}value of a again\mbox{]}

d==$>$\mbox{[}value of d\mbox{]} b==$>$\mbox{[}value of b\mbox{]}

get b=$>$value of b get d=$>$value of d get notthere=$>$

\subsubsection*{A\+U\+T\+H\+OR}

John S. Urban \subsubsection*{L\+I\+C\+E\+N\+SE}

Public Domain 

\subsection{Function/\+Subroutine Documentation}
\mbox{\Hypertarget{namespacem__list_aca66691fd75ea79859a1b4505d2125bb}\label{namespacem__list_aca66691fd75ea79859a1b4505d2125bb}} 
\index{m\+\_\+list@{m\+\_\+list}!dict\+\_\+add@{dict\+\_\+add}}
\index{dict\+\_\+add@{dict\+\_\+add}!m\+\_\+list@{m\+\_\+list}}
\subsubsection{\texorpdfstring{dict\+\_\+add()}{dict\_add()}}
{\footnotesize\ttfamily subroutine m\+\_\+list\+::dict\+\_\+add (\begin{DoxyParamCaption}\item[{class(\mbox{\hyperlink{structm__list_1_1dictionary}{dictionary}}), intent(inout)}]{self,  }\item[{character(len=$\ast$), intent(in)}]{key,  }\item[{character(len=$\ast$), intent(in)}]{value }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [private]}}



\subsubsection*{N\+A\+ME}

dict\+\_\+add(3f) -\/ \mbox{[}M\+\_\+list\mbox{]} add or replace a key-\/value pair in a dictionary (L\+I\+C\+E\+N\+SE\+:PD) 

\subsubsection*{S\+Y\+N\+O\+P\+S\+IS}

subroutine dict\+\_\+add(dict,key,value)

type(dictionary) \+:\+: dict character(len=$\ast$),intent(in) \+:\+: key character(len=$\ast$),intent(in) \+:\+: V\+A\+L\+UE

\subsubsection*{D\+E\+S\+C\+R\+I\+P\+T\+I\+ON}

Add or replace a key-\/value pair in a dictionary.

\subsubsection*{O\+P\+T\+I\+O\+NS}

D\+I\+CT is the dictionary. key key name V\+A\+L\+UE value associated with key

\subsubsection*{E\+X\+A\+M\+P\+L\+ES}

\begin{DoxyVerb}If string is not found in a sorted array, insert the string

 program demo_add
 use M_list, only : dictionary
 implicit none
 type(dictionary) :: dict
 integer          :: i

 call dict%set('A','b')
 call dict%set('B','^')
 call dict%set('C',' ')
 call dict%set('D','c')
 call dict%set('E','ZZ')
 call dict%set('F','ZZZZ')
 call dict%set('G','z')
 call dict%set('A','new value for A')
 write(*,'(*(a,"==>","[",a,"]",/))')(trim(dict%key(i)),dict%value(i)(:dict%count(i)),i=1,size(dict%key))
 end program demo_add

Results:
\end{DoxyVerb}


\subsubsection*{A\+U\+T\+H\+OR}

John S. Urban \subsubsection*{L\+I\+C\+E\+N\+SE}

Public Domain \mbox{\Hypertarget{namespacem__list_aa562d18ce6890a8a1a96d77ff1d39948}\label{namespacem__list_aa562d18ce6890a8a1a96d77ff1d39948}} 
\index{m\+\_\+list@{m\+\_\+list}!dict\+\_\+delete@{dict\+\_\+delete}}
\index{dict\+\_\+delete@{dict\+\_\+delete}!m\+\_\+list@{m\+\_\+list}}
\subsubsection{\texorpdfstring{dict\+\_\+delete()}{dict\_delete()}}
{\footnotesize\ttfamily subroutine m\+\_\+list\+::dict\+\_\+delete (\begin{DoxyParamCaption}\item[{class(\mbox{\hyperlink{structm__list_1_1dictionary}{dictionary}}), intent(inout)}]{self,  }\item[{character(len=$\ast$), intent(in)}]{key }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [private]}}



\subsubsection*{N\+A\+ME}

dict\+\_\+delete(3f) -\/ \mbox{[}M\+\_\+list\mbox{]} delete entry by name from an allocatable sorted string array if it is present (L\+I\+C\+E\+N\+SE\+:PD) 

\subsubsection*{S\+Y\+N\+O\+P\+S\+IS}

subroutine dict\+\_\+delete(key,dict)

character(len=$\ast$),intent(in) \+:\+: key type(dictionary) \+:\+: dict

\subsubsection*{D\+E\+S\+C\+R\+I\+P\+T\+I\+ON}

\begin{DoxyVerb}Find if a string is in a sorted array, and delete the string
from the dictionary if it is present.
\end{DoxyVerb}


\subsubsection*{O\+P\+T\+I\+O\+NS}

\begin{DoxyVerb}KEY           the key name to find and delete from the dictionary.
DICTIONARY    the dictionary.
\end{DoxyVerb}


\subsubsection*{E\+X\+A\+M\+P\+L\+ES}

\begin{DoxyVerb}delete a key from a dictionary by name.

 program demo_dict_delete
 use M_list, only : dictionary
 implicit none
 type(dictionary) :: caps
 integer                       :: i
 call caps%set(caps,'A','aye')
 call caps%set(caps,'B','bee')
 call caps%set(caps,'C','see')
 call caps%set(caps,'D','dee')

 write(*,101)(trim(arr(i)),i=1,size(caps%keys)) ! show array
 call  caps%del(caps,'A')
 call  caps%del(caps,'C')
 call  caps%del(caps,'z')
 write(*,101)(trim(arr(i)),i=1,size(arr)) ! show array
 101 format (1x,*("[",a,"]",:,","))
 end program demo_dict_delete

Results:

 [z],[xxx],[c],[b],[b],[aaa],[ZZZ],[ZZ]
 [z],[xxx],[b],[b],[aaa],[ZZZ],[ZZ]
 [z],[xxx],[b],[b],[aaa],[ZZZ],[ZZ]
 [z],[xxx],[b],[b],[aaa],[ZZZ],[ZZ]
 [z],[xxx],[aaa],[ZZZ],[ZZ]
 [z],[xxx],[aaa],[ZZZ]
 [z],[xxx],[aaa],[ZZZ]
 [xxx],[aaa],[ZZZ]
\end{DoxyVerb}


\subsubsection*{A\+U\+T\+H\+OR}

John S. Urban \subsubsection*{L\+I\+C\+E\+N\+SE}

Public Domain \mbox{\Hypertarget{namespacem__list_a7b9bb0b8fa4b0eeef45d7fcdc21f8bf3}\label{namespacem__list_a7b9bb0b8fa4b0eeef45d7fcdc21f8bf3}} 
\index{m\+\_\+list@{m\+\_\+list}!dict\+\_\+get@{dict\+\_\+get}}
\index{dict\+\_\+get@{dict\+\_\+get}!m\+\_\+list@{m\+\_\+list}}
\subsubsection{\texorpdfstring{dict\+\_\+get()}{dict\_get()}}
{\footnotesize\ttfamily character(len=\+:) function, allocatable m\+\_\+list\+::dict\+\_\+get (\begin{DoxyParamCaption}\item[{class(\mbox{\hyperlink{structm__list_1_1dictionary}{dictionary}})}]{self,  }\item[{character(len=$\ast$), intent(in)}]{key }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [private]}}



\subsubsection*{N\+A\+ME}

dict\+\_\+get(3f) -\/ \mbox{[}M\+\_\+list\mbox{]} get value of key-\/value pair in a dictionary given key (L\+I\+C\+E\+N\+SE\+:PD) 

\subsubsection*{S\+Y\+N\+O\+P\+S\+IS}

subroutine dict\+\_\+get(dict,key,value)

type(dictionary) \+:\+: dict character(len=$\ast$),intent(in) \+:\+: key character(len=$\ast$),intent(in) \+:\+: V\+A\+L\+UE

\subsubsection*{D\+E\+S\+C\+R\+I\+P\+T\+I\+ON}

\begin{DoxyVerb}get a value given a key from a key-value dictionary

If key is not found in dictionary , return a blank
\end{DoxyVerb}


\subsubsection*{O\+P\+T\+I\+O\+NS}

\begin{DoxyVerb}DICT     is the dictionary.
KEY      key name
VALUE    value associated with key
\end{DoxyVerb}


\subsubsection*{E\+X\+A\+M\+P\+L\+ES}

\begin{DoxyVerb} program demo_locate
 use M_list, only : dictionary
 implicit none
 type(dictionary)             :: table
 character(len=:),allocatable :: val
 integer          :: i

 call table%set('A','value for A')
 call table%set('B','value for B')
 call table%set('C','value for C')
 call table%set('D','value for D')
 call table%set('E','value for E')
 call table%set('F','value for F')
 call table%set('G','value for G')
 write(*,*)table%get('A')
 write(*,*)table%get('B')
 write(*,*)table%get('C')
 write(*,*)table%get('D')
 write(*,*)table%get('E')
 write(*,*)table%get('F')
 write(*,*)table%get('G')
 write(*,*)table%get('H')
 end program demo_locate

Results:
\end{DoxyVerb}


\subsubsection*{A\+U\+T\+H\+OR}

John S. Urban \subsubsection*{L\+I\+C\+E\+N\+SE}

Public Domain \mbox{\Hypertarget{namespacem__list_ac9b841bea6c2cfed1608b2809aaf07b4}\label{namespacem__list_ac9b841bea6c2cfed1608b2809aaf07b4}} 
\index{m\+\_\+list@{m\+\_\+list}!insert\+\_\+c@{insert\+\_\+c}}
\index{insert\+\_\+c@{insert\+\_\+c}!m\+\_\+list@{m\+\_\+list}}
\subsubsection{\texorpdfstring{insert\+\_\+c()}{insert\_c()}}
{\footnotesize\ttfamily subroutine, private m\+\_\+list\+::insert\+\_\+c (\begin{DoxyParamCaption}\item[{character(len=\+:), dimension(\+:), allocatable}]{list,  }\item[{character(len=$\ast$), intent(in)}]{value,  }\item[{integer, intent(in)}]{place }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [private]}}



\subsubsection*{N\+A\+ME}

insert(3f) -\/ \mbox{[}M\+\_\+list\mbox{]} insert entry into a string array at specified position (L\+I\+C\+E\+N\+SE\+:PD) 

\subsubsection*{S\+Y\+N\+O\+P\+S\+IS}

subroutine insert(list,value,place)

character(len=$\ast$)$\vert$doubleprecision$\vert$real$\vert$integer,intent(in) \+:\+: value character(len=\+:)$\vert$doubleprecision$\vert$real$\vert$integer,intent(in) \+:\+: list(\+:) integer,intent(in) \+:\+: place

\subsubsection*{D\+E\+S\+C\+R\+I\+P\+T\+I\+ON}

\begin{DoxyVerb}Insert a value into an allocatable array at the specified index.
The list and value must be of the same type (CHARACTER, DOUBLEPRECISION,
REAL, or INTEGER)
\end{DoxyVerb}


\subsubsection*{O\+P\+T\+I\+O\+NS}

\begin{DoxyVerb}list    is the list array. Must be sorted in descending order.
value   the value to place in the array
PLACE   is the subscript that the entry should be placed at
\end{DoxyVerb}


\subsubsection*{E\+X\+A\+M\+P\+L\+ES}

\begin{DoxyVerb}Find if a string is in a sorted array, and insert the string into
the list if it is not present ...

 program demo_insert
 use M_sort, only : sort_shell
 use M_list, only : locate, insert
 implicit none
 character(len=:),allocatable :: arr(:)
 integer                       :: i

 arr=[character(len=20) :: '', 'ZZZ', 'aaa', 'b', 'xxx' ]
 ! make sure sorted in descending order
 call sort_shell(arr,order='d')
 ! add or replace values
 call update(arr,'b')
 call update(arr,'[')
 call update(arr,'c')
 call update(arr,'ZZ')
 call update(arr,'ZZZ')
 call update(arr,'ZZZZ')
 call update(arr,'')
 call update(arr,'z')

 contains
 subroutine update(arr,string)
 character(len=:),allocatable :: arr(:)
 character(len=*)             :: string
 integer                      :: place, end

 end=size(arr)
 ! find where string is or should be
 call locate(arr,string,place)
 ! if string was not found insert it
 if(place.lt.1)then
    call insert(arr,string,abs(place))
 endif
 ! show array
 end=size(arr)
 write(*,'("array is now SIZE=",i0,1x,*(a,","))')end,(trim(arr(i)),i=1,end)

 end subroutine update
 end program demo_insert
\end{DoxyVerb}


Results\+:

array is now S\+I\+ZE=5 xxx,b,aaa,Z\+ZZ,, array is now S\+I\+ZE=6 xxx,b,aaa,\mbox{[},Z\+ZZ,, array is now S\+I\+ZE=7 xxx,c,b,aaa,\mbox{[},Z\+ZZ,, array is now S\+I\+ZE=8 xxx,c,b,aaa,\mbox{[},Z\+ZZ,ZZ,, array is now S\+I\+ZE=9 xxx,c,b,aaa,\mbox{[},Z\+Z\+ZZ,Z\+ZZ,ZZ,, array is now S\+I\+ZE=10 z,xxx,c,b,aaa,\mbox{[},Z\+Z\+ZZ,Z\+ZZ,ZZ,,

\subsubsection*{A\+U\+T\+H\+OR}

1989,2017 John S. Urban \subsubsection*{L\+I\+C\+E\+N\+SE}

Public Domain 

References debug.

\mbox{\Hypertarget{namespacem__list_ae2356cb1ec5b313c3fcbad090d6eb440}\label{namespacem__list_ae2356cb1ec5b313c3fcbad090d6eb440}} 
\index{m\+\_\+list@{m\+\_\+list}!insert\+\_\+d@{insert\+\_\+d}}
\index{insert\+\_\+d@{insert\+\_\+d}!m\+\_\+list@{m\+\_\+list}}
\subsubsection{\texorpdfstring{insert\+\_\+d()}{insert\_d()}}
{\footnotesize\ttfamily subroutine, private m\+\_\+list\+::insert\+\_\+d (\begin{DoxyParamCaption}\item[{doubleprecision, dimension(\+:), allocatable}]{list,  }\item[{doubleprecision, intent(in)}]{value,  }\item[{integer, intent(in)}]{place }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [private]}}



References debug.

\mbox{\Hypertarget{namespacem__list_a7d50f88bd8d25138af4e6d484aca2cbc}\label{namespacem__list_a7d50f88bd8d25138af4e6d484aca2cbc}} 
\index{m\+\_\+list@{m\+\_\+list}!insert\+\_\+i@{insert\+\_\+i}}
\index{insert\+\_\+i@{insert\+\_\+i}!m\+\_\+list@{m\+\_\+list}}
\subsubsection{\texorpdfstring{insert\+\_\+i()}{insert\_i()}}
{\footnotesize\ttfamily subroutine, private m\+\_\+list\+::insert\+\_\+i (\begin{DoxyParamCaption}\item[{integer, dimension(\+:), allocatable}]{list,  }\item[{integer, intent(in)}]{value,  }\item[{integer, intent(in)}]{place }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [private]}}



References debug.

\mbox{\Hypertarget{namespacem__list_a6108584670ced9dc4469e76ceb808730}\label{namespacem__list_a6108584670ced9dc4469e76ceb808730}} 
\index{m\+\_\+list@{m\+\_\+list}!insert\+\_\+l@{insert\+\_\+l}}
\index{insert\+\_\+l@{insert\+\_\+l}!m\+\_\+list@{m\+\_\+list}}
\subsubsection{\texorpdfstring{insert\+\_\+l()}{insert\_l()}}
{\footnotesize\ttfamily subroutine, private m\+\_\+list\+::insert\+\_\+l (\begin{DoxyParamCaption}\item[{logical, dimension(\+:), allocatable}]{list,  }\item[{logical, intent(in)}]{value,  }\item[{integer, intent(in)}]{place }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [private]}}



References debug.

\mbox{\Hypertarget{namespacem__list_affd8a9996750ccf655cf677136d9fc4e}\label{namespacem__list_affd8a9996750ccf655cf677136d9fc4e}} 
\index{m\+\_\+list@{m\+\_\+list}!insert\+\_\+r@{insert\+\_\+r}}
\index{insert\+\_\+r@{insert\+\_\+r}!m\+\_\+list@{m\+\_\+list}}
\subsubsection{\texorpdfstring{insert\+\_\+r()}{insert\_r()}}
{\footnotesize\ttfamily subroutine, private m\+\_\+list\+::insert\+\_\+r (\begin{DoxyParamCaption}\item[{real, dimension(\+:), allocatable}]{list,  }\item[{real, intent(in)}]{value,  }\item[{integer, intent(in)}]{place }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [private]}}



References debug.

\mbox{\Hypertarget{namespacem__list_aeb2a9d8e479c44cca127db7c65abb1f3}\label{namespacem__list_aeb2a9d8e479c44cca127db7c65abb1f3}} 
\index{m\+\_\+list@{m\+\_\+list}!locate\+\_\+c@{locate\+\_\+c}}
\index{locate\+\_\+c@{locate\+\_\+c}!m\+\_\+list@{m\+\_\+list}}
\subsubsection{\texorpdfstring{locate\+\_\+c()}{locate\_c()}}
{\footnotesize\ttfamily subroutine, private m\+\_\+list\+::locate\+\_\+c (\begin{DoxyParamCaption}\item[{character(len=\+:), dimension(\+:), allocatable}]{list,  }\item[{character(len=$\ast$), intent(in)}]{value,  }\item[{integer, intent(out)}]{place,  }\item[{integer, intent(out), optional}]{ier,  }\item[{character(len=$\ast$), intent(out), optional}]{errmsg }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [private]}}



\subsubsection*{N\+A\+ME}

locate(3f) -\/ \mbox{[}M\+\_\+list\mbox{]} finds the index where a string is found or should be in a sorted array (L\+I\+C\+E\+N\+SE\+:PD) 

\subsubsection*{S\+Y\+N\+O\+P\+S\+IS}

subroutine locate(list,value,place,ier,errmsg)

character(len=\+:)$\vert$doubleprecision$\vert$real$\vert$integer,allocatable \+:\+: list(\+:) character(len=$\ast$)$\vert$doubleprecision$\vert$real$\vert$integer,intent(in) \+:\+: value integer, intent(out) \+:\+: P\+L\+A\+CE

integer, intent(out),optional \+:\+: I\+ER character(len=$\ast$),intent(out),optional \+:\+: E\+R\+R\+M\+SG

\subsubsection*{D\+E\+S\+C\+R\+I\+P\+T\+I\+ON}

\begin{DoxyVerb}LOCATE(3f) finds the index where the VALUE is found or should
be found in an array. The array must be sorted in descending
order (highest at top). If VALUE is not found it returns the index
where the name should be placed at with a negative sign.

The array and list must be of the same type (CHARACTER, DOUBLEPRECISION,
REAL,INTEGER)
\end{DoxyVerb}


\subsubsection*{O\+P\+T\+I\+O\+NS}

\begin{DoxyVerb}VALUE         the value to locate in the list.
LIST          is the list array.
\end{DoxyVerb}


\subsubsection*{R\+E\+T\+U\+R\+NS}

P\+L\+A\+CE is the subscript that the entry was found at if it is greater than zero(0).

If P\+L\+A\+CE is negative, the absolute value of P\+L\+A\+CE indicates the subscript value where the new entry should be placed in order to keep the list alphabetized.

I\+ER is zero(0) if no error occurs. If an error occurs and I\+ER is not present, the program is stopped.

E\+R\+R\+M\+SG description of any error

\subsubsection*{E\+X\+A\+M\+P\+L\+ES}

\begin{DoxyVerb}Find if a string is in a sorted array, and insert the string into
the list if it is not present ...

 program demo_locate
 use M_sort, only : sort_shell
 use M_list, only : locate
 implicit none
 character(len=:),allocatable  :: arr(:)
 integer                       :: i

 arr=[character(len=20) :: '', 'ZZZ', 'aaa', 'b', 'xxx' ]
 ! make sure sorted in descending order
 call sort_shell(arr,order='d')

 call update(arr,'b')
 call update(arr,'[')
 call update(arr,'c')
 call update(arr,'ZZ')
 call update(arr,'ZZZZ')
 call update(arr,'z')

 contains
 subroutine update(arr,string)
 character(len=:),allocatable :: arr(:)
 character(len=*)             :: string
 integer                      :: place, plus, ii, end
 ! find where string is or should be
 call locate(arr,string,place)
 write(*,*)'for "'//string//'" index is ',place, size(arr)
 ! if string was not found insert it
 if(place.lt.1)then
    plus=abs(place)
    ii=len(arr)
    end=size(arr)
    ! empty array
    if(end.eq.0)then
       arr=[character(len=ii) :: string ]
    ! put in front of array
    elseif(plus.eq.1)then
       arr=[character(len=ii) :: string, arr]
    ! put at end of array
    elseif(plus.eq.end)then
       arr=[character(len=ii) :: arr, string ]
    ! put in middle of array
    else
       arr=[character(len=ii) :: arr(:plus-1), string,arr(plus:) ]
    endif
    ! show array
    write(*,'("SIZE=",i0,1x,*(a,","))')end,(trim(arr(i)),i=1,end)
 endif
 end subroutine update
 end program demo_locate
\end{DoxyVerb}


Results\+:

for \char`\"{}b\char`\"{} index is 2 5 for \char`\"{}\mbox{[}\char`\"{} index is -\/4 5 S\+I\+ZE=5 xxx,b,aaa,\mbox{[},Z\+ZZ, for \char`\"{}c\char`\"{} index is -\/2 6 S\+I\+ZE=6 xxx,c,b,aaa,\mbox{[},Z\+ZZ, for \char`\"{}\+Z\+Z\char`\"{} index is -\/7 7 S\+I\+ZE=7 xxx,c,b,aaa,\mbox{[},Z\+ZZ,, for \char`\"{}\+Z\+Z\+Z\+Z\char`\"{} index is -\/6 8 S\+I\+ZE=8 xxx,c,b,aaa,\mbox{[},Z\+Z\+ZZ,Z\+ZZ,, for \char`\"{}z\char`\"{} index is -\/1 9 S\+I\+ZE=9 z,xxx,c,b,aaa,\mbox{[},Z\+Z\+ZZ,Z\+ZZ,,

\subsubsection*{A\+U\+T\+H\+OR}

1989,2017 John S. Urban \subsubsection*{L\+I\+C\+E\+N\+SE}

Public Domain \mbox{\Hypertarget{namespacem__list_a6b746f0ad79a6fbfbafcf0ee22e38891}\label{namespacem__list_a6b746f0ad79a6fbfbafcf0ee22e38891}} 
\index{m\+\_\+list@{m\+\_\+list}!locate\+\_\+d@{locate\+\_\+d}}
\index{locate\+\_\+d@{locate\+\_\+d}!m\+\_\+list@{m\+\_\+list}}
\subsubsection{\texorpdfstring{locate\+\_\+d()}{locate\_d()}}
{\footnotesize\ttfamily subroutine, private m\+\_\+list\+::locate\+\_\+d (\begin{DoxyParamCaption}\item[{doubleprecision, dimension(\+:), allocatable}]{list,  }\item[{doubleprecision, intent(in)}]{value,  }\item[{integer, intent(out)}]{place,  }\item[{integer, intent(out), optional}]{ier,  }\item[{character(len=$\ast$), intent(out), optional}]{errmsg }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [private]}}

\mbox{\Hypertarget{namespacem__list_a5b1b93df5003d6dce72acba89e779638}\label{namespacem__list_a5b1b93df5003d6dce72acba89e779638}} 
\index{m\+\_\+list@{m\+\_\+list}!locate\+\_\+i@{locate\+\_\+i}}
\index{locate\+\_\+i@{locate\+\_\+i}!m\+\_\+list@{m\+\_\+list}}
\subsubsection{\texorpdfstring{locate\+\_\+i()}{locate\_i()}}
{\footnotesize\ttfamily subroutine, private m\+\_\+list\+::locate\+\_\+i (\begin{DoxyParamCaption}\item[{integer, dimension(\+:), allocatable}]{list,  }\item[{integer, intent(in)}]{value,  }\item[{integer, intent(out)}]{place,  }\item[{integer, intent(out), optional}]{ier,  }\item[{character(len=$\ast$), intent(out), optional}]{errmsg }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [private]}}



References debug.

\mbox{\Hypertarget{namespacem__list_a533a0e5b16558efb391913e881a57040}\label{namespacem__list_a533a0e5b16558efb391913e881a57040}} 
\index{m\+\_\+list@{m\+\_\+list}!locate\+\_\+r@{locate\+\_\+r}}
\index{locate\+\_\+r@{locate\+\_\+r}!m\+\_\+list@{m\+\_\+list}}
\subsubsection{\texorpdfstring{locate\+\_\+r()}{locate\_r()}}
{\footnotesize\ttfamily subroutine, private m\+\_\+list\+::locate\+\_\+r (\begin{DoxyParamCaption}\item[{real, dimension(\+:), allocatable}]{list,  }\item[{real, intent(in)}]{value,  }\item[{integer, intent(out)}]{place,  }\item[{integer, intent(out), optional}]{ier,  }\item[{character(len=$\ast$), intent(out), optional}]{errmsg }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [private]}}

\mbox{\Hypertarget{namespacem__list_a216c9ec18769ee63a769cc25bc273022}\label{namespacem__list_a216c9ec18769ee63a769cc25bc273022}} 
\index{m\+\_\+list@{m\+\_\+list}!remove\+\_\+c@{remove\+\_\+c}}
\index{remove\+\_\+c@{remove\+\_\+c}!m\+\_\+list@{m\+\_\+list}}
\subsubsection{\texorpdfstring{remove\+\_\+c()}{remove\_c()}}
{\footnotesize\ttfamily subroutine, private m\+\_\+list\+::remove\+\_\+c (\begin{DoxyParamCaption}\item[{character(len=\+:), dimension(\+:), allocatable}]{list,  }\item[{integer, intent(in)}]{place }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [private]}}



\subsubsection*{N\+A\+ME}

remove(3f) -\/ \mbox{[}M\+\_\+list\mbox{]} remove entry from an allocatable array at specified position (L\+I\+C\+E\+N\+SE\+:PD) 

\subsubsection*{S\+Y\+N\+O\+P\+S\+IS}

subroutine remove(list,place)

character(len=\+:)$\vert$doubleprecision$\vert$real$\vert$integer,intent(inout) \+:\+: list(\+:) integer, intent(out) \+:\+: P\+L\+A\+CE

\subsubsection*{D\+E\+S\+C\+R\+I\+P\+T\+I\+ON}

\begin{DoxyVerb}Remove a value from an allocatable array at the specified index.
The array is assumed to be sorted in descending order. It may be of
type CHARACTER, DOUBLEPRECISION, REAL, or INTEGER.
\end{DoxyVerb}


\subsubsection*{O\+P\+T\+I\+O\+NS}

\begin{DoxyVerb}list    is the list array.
PLACE   is the subscript for the entry that should be removed
\end{DoxyVerb}


\subsubsection*{E\+X\+A\+M\+P\+L\+ES}

\begin{DoxyVerb}Sample program

 program demo_remove
 use M_sort, only : sort_shell
 use M_list, only : locate, remove
 implicit none
 character(len=:),allocatable :: arr(:)
 integer                       :: i
 integer                       :: end

 arr=[character(len=20) :: '', 'ZZZ', 'Z', 'aaa', 'b', 'b', 'ab', 'bb', 'xxx' ]
 ! make sure sorted in descending order
 call sort_shell(arr,order='d')

 end=size(arr)
 write(*,'("SIZE=",i0,1x,*(a,","))')end,(trim(arr(i)),i=1,end)
 call remove(arr,1)
 end=size(arr)
 write(*,'("SIZE=",i0,1x,*(a,","))')end,(trim(arr(i)),i=1,end)
 call remove(arr,4)
 end=size(arr)
 write(*,'("SIZE=",i0,1x,*(a,","))')end,(trim(arr(i)),i=1,end)

 end program demo_remove
\end{DoxyVerb}


Results\+:

Expected output

S\+I\+ZE=9 xxx,bb,b,b,ab,aaa,Z\+ZZ,Z,, S\+I\+ZE=8 bb,b,b,ab,aaa,Z\+ZZ,Z,, S\+I\+ZE=7 bb,b,b,aaa,Z\+ZZ,Z,,

\subsubsection*{A\+U\+T\+H\+OR}

1989,2017 John S. Urban \subsubsection*{L\+I\+C\+E\+N\+SE}

Public Domain 

References debug.

\mbox{\Hypertarget{namespacem__list_a6c5f971866302b40b5952ad919203461}\label{namespacem__list_a6c5f971866302b40b5952ad919203461}} 
\index{m\+\_\+list@{m\+\_\+list}!remove\+\_\+d@{remove\+\_\+d}}
\index{remove\+\_\+d@{remove\+\_\+d}!m\+\_\+list@{m\+\_\+list}}
\subsubsection{\texorpdfstring{remove\+\_\+d()}{remove\_d()}}
{\footnotesize\ttfamily subroutine, private m\+\_\+list\+::remove\+\_\+d (\begin{DoxyParamCaption}\item[{doubleprecision, dimension(\+:), allocatable}]{list,  }\item[{integer, intent(in)}]{place }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [private]}}



References debug.

\mbox{\Hypertarget{namespacem__list_acdc3299515ed0402f4213d76d3e4d4cf}\label{namespacem__list_acdc3299515ed0402f4213d76d3e4d4cf}} 
\index{m\+\_\+list@{m\+\_\+list}!remove\+\_\+i@{remove\+\_\+i}}
\index{remove\+\_\+i@{remove\+\_\+i}!m\+\_\+list@{m\+\_\+list}}
\subsubsection{\texorpdfstring{remove\+\_\+i()}{remove\_i()}}
{\footnotesize\ttfamily subroutine, private m\+\_\+list\+::remove\+\_\+i (\begin{DoxyParamCaption}\item[{integer, dimension(\+:), allocatable}]{list,  }\item[{integer, intent(in)}]{place }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [private]}}



References debug.

\mbox{\Hypertarget{namespacem__list_a138b6450613db943177df6258f58e89b}\label{namespacem__list_a138b6450613db943177df6258f58e89b}} 
\index{m\+\_\+list@{m\+\_\+list}!remove\+\_\+l@{remove\+\_\+l}}
\index{remove\+\_\+l@{remove\+\_\+l}!m\+\_\+list@{m\+\_\+list}}
\subsubsection{\texorpdfstring{remove\+\_\+l()}{remove\_l()}}
{\footnotesize\ttfamily subroutine, private m\+\_\+list\+::remove\+\_\+l (\begin{DoxyParamCaption}\item[{logical, dimension(\+:), allocatable}]{list,  }\item[{integer, intent(in)}]{place }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [private]}}



References debug.

\mbox{\Hypertarget{namespacem__list_af5940ed6b39d9e3429e2784767db9e56}\label{namespacem__list_af5940ed6b39d9e3429e2784767db9e56}} 
\index{m\+\_\+list@{m\+\_\+list}!remove\+\_\+r@{remove\+\_\+r}}
\index{remove\+\_\+r@{remove\+\_\+r}!m\+\_\+list@{m\+\_\+list}}
\subsubsection{\texorpdfstring{remove\+\_\+r()}{remove\_r()}}
{\footnotesize\ttfamily subroutine, private m\+\_\+list\+::remove\+\_\+r (\begin{DoxyParamCaption}\item[{real, dimension(\+:), allocatable}]{list,  }\item[{integer, intent(in)}]{place }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [private]}}



References debug.

\mbox{\Hypertarget{namespacem__list_adddd2b7443557b3727320c314170e001}\label{namespacem__list_adddd2b7443557b3727320c314170e001}} 
\index{m\+\_\+list@{m\+\_\+list}!replace\+\_\+c@{replace\+\_\+c}}
\index{replace\+\_\+c@{replace\+\_\+c}!m\+\_\+list@{m\+\_\+list}}
\subsubsection{\texorpdfstring{replace\+\_\+c()}{replace\_c()}}
{\footnotesize\ttfamily subroutine, private m\+\_\+list\+::replace\+\_\+c (\begin{DoxyParamCaption}\item[{character(len=\+:), dimension(\+:), allocatable}]{list,  }\item[{character(len=$\ast$), intent(in)}]{value,  }\item[{integer, intent(in)}]{place }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [private]}}



\subsubsection*{N\+A\+ME}

replace(3f) -\/ \mbox{[}M\+\_\+list\mbox{]} replace entry in a string array at specified position (L\+I\+C\+E\+N\+SE\+:PD) 

\subsubsection*{S\+Y\+N\+O\+P\+S\+IS}

subroutine replace(list,value,place)

character(len=$\ast$)$\vert$doubleprecision$\vert$real$\vert$integer,intent(in) \+:\+: value character(len=\+:)$\vert$doubleprecision$\vert$real$\vert$integer,intent(in) \+:\+: list(\+:) integer, intent(out) \+:\+: P\+L\+A\+CE

\subsubsection*{D\+E\+S\+C\+R\+I\+P\+T\+I\+ON}

\begin{DoxyVerb}replace a value in an allocatable array at the specified index. Unless the
array needs the string length to increase this is merely an assign of a value
to an array element.

The array may be of type CHARACTER, DOUBLEPRECISION, REAL, or INTEGER>
It is assumed to be sorted in descending order without duplicate values.

The value and list must be of the same type.
\end{DoxyVerb}


\subsubsection*{O\+P\+T\+I\+O\+NS}

\begin{DoxyVerb}VALUE         the value to place in the array
LIST          is the array.
PLACE         is the subscript that the entry should be placed at
\end{DoxyVerb}


\subsubsection*{E\+X\+A\+M\+P\+L\+ES}

Replace key-\/value pairs in a dictionary

program demo\+\_\+replace use M\+\_\+list, only \+: insert, locate, replace ! Find if a key is in a list and insert it ! into the key list and value list if it is not present ! or replace the associated value if the key existed implicit none character(len=20) \+:\+: key character(len=100) \+:\+: val character(len=\+:),allocatable \+:\+: keywords(\+:) character(len=\+:),allocatable \+:\+: values(\+:) integer \+:\+: i integer \+:\+: place call update(\textquotesingle{}b\textquotesingle{},\textquotesingle{}value of b\textquotesingle{}) call update(\textquotesingle{}a\textquotesingle{},\textquotesingle{}value of a\textquotesingle{}) call update(\textquotesingle{}c\textquotesingle{},\textquotesingle{}value of c\textquotesingle{}) call update(\textquotesingle{}c\textquotesingle{},\textquotesingle{}value of c again\textquotesingle{}) call update(\textquotesingle{}d\textquotesingle{},\textquotesingle{}value of d\textquotesingle{}) call update(\textquotesingle{}a\textquotesingle{},\textquotesingle{}value of a again\textquotesingle{}) ! show array write($\ast$,\textquotesingle{}($\ast$(a,\char`\"{}==$>$\char`\"{},a,/))\textquotesingle{})(trim(keywords(i)),trim(values(i)),i=1,size(keywords))

call locate(keywords,\textquotesingle{}a\textquotesingle{},place) if(place.\+gt.\+0)then write($\ast$,$\ast$)\textquotesingle{}The value of \char`\"{}a\char`\"{} is\textquotesingle{},trim(values(place)) else write($\ast$,$\ast$)\textquotesingle{}\char`\"{}a\char`\"{} not found\textquotesingle{} endif

contains subroutine update(key,val) character(len=$\ast$),intent(in) \+:\+: key character(len=$\ast$),intent(in) \+:\+: val integer \+:\+: place

! find where string is or should be call locate(keywords,key,place) ! if string was not found insert it if(place.\+lt.\+1)then call insert(keywords,key,abs(place)) call insert(values,val,abs(place)) else ! replace call replace(values,val,place) endif

end subroutine update end program demo\+\_\+replace

Expected output

d==$>$value of d c==$>$value of c again b==$>$value of b a==$>$value of a again

\subsubsection*{A\+U\+T\+H\+OR}

1989,2017 John S. Urban \subsubsection*{L\+I\+C\+E\+N\+SE}

Public Domain 

References debug.

\mbox{\Hypertarget{namespacem__list_a9cac0a0b0d325d26267d37648f8eada6}\label{namespacem__list_a9cac0a0b0d325d26267d37648f8eada6}} 
\index{m\+\_\+list@{m\+\_\+list}!replace\+\_\+d@{replace\+\_\+d}}
\index{replace\+\_\+d@{replace\+\_\+d}!m\+\_\+list@{m\+\_\+list}}
\subsubsection{\texorpdfstring{replace\+\_\+d()}{replace\_d()}}
{\footnotesize\ttfamily subroutine, private m\+\_\+list\+::replace\+\_\+d (\begin{DoxyParamCaption}\item[{doubleprecision, dimension(\+:), allocatable}]{list,  }\item[{doubleprecision, intent(in)}]{value,  }\item[{integer, intent(in)}]{place }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [private]}}



References debug.

\mbox{\Hypertarget{namespacem__list_a8c67651ca2c2c90d921f23146577491b}\label{namespacem__list_a8c67651ca2c2c90d921f23146577491b}} 
\index{m\+\_\+list@{m\+\_\+list}!replace\+\_\+i@{replace\+\_\+i}}
\index{replace\+\_\+i@{replace\+\_\+i}!m\+\_\+list@{m\+\_\+list}}
\subsubsection{\texorpdfstring{replace\+\_\+i()}{replace\_i()}}
{\footnotesize\ttfamily subroutine, private m\+\_\+list\+::replace\+\_\+i (\begin{DoxyParamCaption}\item[{integer, dimension(\+:), allocatable}]{list,  }\item[{integer, intent(in)}]{value,  }\item[{integer, intent(in)}]{place }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [private]}}



References debug.

\mbox{\Hypertarget{namespacem__list_a0de977b7f38554ccd2e8b6e668f11648}\label{namespacem__list_a0de977b7f38554ccd2e8b6e668f11648}} 
\index{m\+\_\+list@{m\+\_\+list}!replace\+\_\+l@{replace\+\_\+l}}
\index{replace\+\_\+l@{replace\+\_\+l}!m\+\_\+list@{m\+\_\+list}}
\subsubsection{\texorpdfstring{replace\+\_\+l()}{replace\_l()}}
{\footnotesize\ttfamily subroutine, private m\+\_\+list\+::replace\+\_\+l (\begin{DoxyParamCaption}\item[{logical, dimension(\+:), allocatable}]{list,  }\item[{logical, intent(in)}]{value,  }\item[{integer, intent(in)}]{place }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [private]}}



References debug.

\mbox{\Hypertarget{namespacem__list_ac2ef50718d66bfe2fc102a3d48a28cb2}\label{namespacem__list_ac2ef50718d66bfe2fc102a3d48a28cb2}} 
\index{m\+\_\+list@{m\+\_\+list}!replace\+\_\+r@{replace\+\_\+r}}
\index{replace\+\_\+r@{replace\+\_\+r}!m\+\_\+list@{m\+\_\+list}}
\subsubsection{\texorpdfstring{replace\+\_\+r()}{replace\_r()}}
{\footnotesize\ttfamily subroutine, private m\+\_\+list\+::replace\+\_\+r (\begin{DoxyParamCaption}\item[{real, dimension(\+:), allocatable}]{list,  }\item[{real, intent(in)}]{value,  }\item[{integer, intent(in)}]{place }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [private]}}



References debug.



\subsection{Variable Documentation}
\mbox{\Hypertarget{namespacem__list_aaa3ea916cd8c669ebbc8ec9096c5bbca}\label{namespacem__list_aaa3ea916cd8c669ebbc8ec9096c5bbca}} 
\index{m\+\_\+list@{m\+\_\+list}!debug@{debug}}
\index{debug@{debug}!m\+\_\+list@{m\+\_\+list}}
\subsubsection{\texorpdfstring{debug}{debug}}
{\footnotesize\ttfamily logical, save m\+\_\+list\+::debug =.false.\hspace{0.3cm}{\ttfamily [private]}}

